<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALIBEST DEALS - LEGO Finds, Reviews & More</title> 
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
    <style>
        /* ====[ Global Styles & Resets ]==== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Arial', sans-serif; 
            line-height: 1.6; 
            color: #333; 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); 
            opacity: 0;
            animation: siteFadeIn 0.7s 0.2s ease-out forwards;
            /* padding-top will be set by JS for fixed header on desktop */
        }
        @keyframes siteFadeIn { to { opacity: 1; } }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        h1, h2, h3 { margin-bottom: 0.75em; }
        a { color: #667eea; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .section { padding: 3rem 0; }
        .section-title { text-align: center; font-size: 2.5rem; margin-bottom: 2.5rem; background: linear-gradient(45deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .section-title.visible { opacity: 1; transform: translateY(0); }

        /* ====[ Header & Navigation ]==== */
        header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            color: white; 
            padding: 0.5rem 0;
            position: fixed; 
            top: 0; left: 0; right: 0;
            z-index: 1000; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            height: 70px; 
            transition: top 0.3s; 
        }
        .header-content { display: flex; justify-content: space-between; align-items: center; height: 100%; }
        .logo-container { height: 50px; display: flex; align-items: center; }
        .logo-container a { display: flex; align-items: center; height: 100%; text-decoration: none;}
        .logo-container img { max-height: 100%; width: auto; object-fit: contain; }
        
        nav#mainNav { display: flex; } 
        nav#mainNav ul { display: flex; list-style: none; gap: 1.5rem; align-items: center; }
        nav#mainNav a { color: white; font-weight: bold; transition: color 0.2s, border-bottom-color 0.2s, background-color 0.2s; padding: 0.5rem 0.3rem; border-bottom: 3px solid transparent; }
        nav#mainNav a:hover { color: #ffd073; border-bottom-color: #ffd073; }
        nav#mainNav a.active { color: #ffa500; border-bottom-color: #ffa500; background-color: rgba(255,255,255,0.05); border-radius:5px 5px 0 0;}

        .menu-toggle { display: none; cursor: pointer; padding: 0.5rem; z-index: 1001; }
        .menu-toggle .bar { display: block; width: 25px; height: 3px; margin: 5px auto; background-color: white; transition: all 0.3s ease-in-out; }

        /* ====[ Hero Section ]==== */
        .hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-align: center; }
        .hero h1 { font-size: 3rem; animation: fadeInUp 1s 0.3s ease-out backwards; } 
        .hero p { font-size: 1.2rem; margin-bottom: 2rem; animation: fadeInUp 1s 0.5s ease-out backwards; } 
        .cta-button { background: linear-gradient(45deg, #ff6b6b, #ffa500); color: white; padding: 1rem 2rem; border: none; border-radius: 30px; font-size: 1.1rem; cursor: pointer; transition: all 0.3s; text-decoration: none; display: inline-block; }
        .hero .cta-button { animation: fadeInUp 1s 0.7s ease-out backwards; } 
        .cta-button:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3); }

        /* ====[ Product Filters & Sorting ]==== */
        .filters-toolbar { margin-bottom: 2rem; padding: 1rem; background-color: #fff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 1rem; }
        .filter-group { display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center;}
        .filter-group strong { margin-right: 0.5rem; font-size: 0.9rem; color: #555;}
        .filter-btn { padding: 0.6rem 1.2rem; border: 1px solid #e0e0e0; background-color: #f8f9fa; color: #495057; border-radius: 20px; cursor: pointer; transition: all 0.2s ease-in-out; font-size: 0.9rem; font-weight: 500; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .filter-btn:hover { background-color: #e9ecef; border-color: #adb5bd; transform: translateY(-1px); }
        .filter-btn.active { background-color: #667eea; color: white; border-color: #667eea; box-shadow: 0 2px 5px rgba(102,126,234,0.3); }
        .sort-select { padding: 0.6rem 1rem; border: 1px solid #ddd; background-color: #f9f9f9; color: #555; border-radius: 20px; cursor: pointer; transition: all 0.2s; font-size: 0.9rem; -webkit-appearance: none; appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%236c757d%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'); background-repeat: no-repeat; background-position: right .7em top 50%; background-size: .65em auto; padding-right: 2.2em; }
        .sort-select:hover { background-color: #efefef; border-color: #ccc;}

        /* ====[ Products Grid & Cards ]==== */
        .products-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; margin-top: 2rem; }
        .product-card { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.1); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); position: relative; display: flex; flex-direction: column; opacity: 0; transform: translateY(30px); }
        .product-card.visible { opacity: 1; transform: translateY(0); }
        .product-card:hover { transform: translateY(-12px) scale(1.02); box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .product-image-container { cursor: pointer; background-color: #f0f0f0; position: relative; overflow: hidden;}
        .product-image { width: 100%; height: 250px; object-fit: contain; display: block; transition: transform 0.4s ease; }
        .product-card:hover .product-image { transform: scale(1.05); }
        .product-badges { position: absolute; top: 10px; left:0; display: flex; flex-direction: column; gap: 5px; z-index: 1; }
        .badge { padding: 0.3rem 0.8rem; border-radius: 0 10px 10px 0; font-size: 0.8rem; font-weight: bold; color: white; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
        .discount-badge { background: linear-gradient(45deg, #ff6b6b, #ffa500); }
        .hot-deal-badge { background: linear-gradient(45deg, #e74c3c, #c0392b); }
        .product-info { padding: 1.5rem; display: flex; flex-direction: column; flex-grow: 1; }
        .product-title { font-size: 1.2rem; margin-bottom: 0.5rem; color: #333; height: 2.4em; line-height: 1.2em; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; cursor: pointer; }
        .product-description { color: #666; font-size: 0.9rem; margin-bottom: 1rem; height: 4.05em; line-height: 1.35em; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; flex-grow: 1; }
        .product-rating { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; }
        .stars { color: #ffa500; }
        .rating-count { color: #666; font-size: 0.9rem; }
        .product-price { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; }
        .current-price { font-size: 1.5rem; font-weight: bold; color: #ff6b6b; }
        .original-price { text-decoration: line-through; color: #999; }
        .product-action-button { width: 100%; background: linear-gradient(45deg, #667eea, #764ba2); color: white; border: none; padding: 0.8rem; border-radius: 25px; cursor: pointer; transition: all 0.3s; font-weight: bold; text-align: center; text-decoration: none; display: inline-block; margin-top: auto; font-size: 0.95rem;}
        .product-action-button:hover { transform: scale(1.02); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3); }

        /* ====[ Modal ]==== */
        .modal { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); animation: fadeIn 0.3s ease-out; overflow-y: auto; padding: 20px; }
        .modal-content { background-color: white; margin: 5% auto; padding: 2rem; border-radius: 15px; width: 90%; max-width: 800px; position: relative; }
        .modal-close { position: absolute; right: 1rem; top: 1rem; font-size: 2rem; cursor: pointer; color: #999; }
        .modal-close:hover { color: #333; }
        .modal-product { display: grid; grid-template-columns: 1fr 1.2fr; gap: 2rem; align-items: start; }
        .modal-image-container { background-color: #f0f0f0; border-radius: 10px; }
        .modal-image { width: 100%; border-radius: 10px; object-fit: contain; max-height: 400px; display: block; }
        .modal-report-button { background: #f0f0f0; color: #555; border: 1px solid #ddd; padding: 0.6rem 1rem; border-radius: 20px; cursor: pointer; transition: background-color 0.2s; font-size: 0.9rem; margin-top:1.5rem; display:inline-block;}
        .modal-report-button:hover { background-color: #e0e0e0;}

        /* ====[ Why Choose Us ]==== */
        .why-choose { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 2rem; }
        .feature-card { background: white; padding: 2rem; border-radius: 15px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.1); transition: transform 0.4s ease-out, opacity 0.4s ease-out; opacity: 0; transform: translateY(30px); }
        .feature-card.visible { opacity: 1; transform: translateY(0); }
        .feature-card:hover { transform: translateY(-5px) scale(1.03); }
        .feature-icon { font-size: 3rem; margin-bottom: 1rem; background: linear-gradient(45deg, #ff6b6b, #ffa500); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        
        /* ====[ Footer ]==== */
        footer { background: #333; color: white; padding: 2rem 0; text-align: center; }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem; }
        .footer-section h3 { margin-bottom: 1rem; color: #ffa500; }
        .footer-section a, .footer-section p { color: #ccc; text-decoration: none; display: block; margin-bottom: 0.5rem; transition: color 0.3s; }
        .footer-section a:hover { color: #ffa500; }

        /* ====[ Contact/Requests Form Section ]==== */
        .form-section { background-color: #fff; padding: 2.5rem; border-radius: 8px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); max-width: 700px; margin: 2rem auto; }
        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: .5rem; font-weight: bold; color: #555; }
        .form-group input[type="text"], .form-group input[type="email"], .form-group textarea { width: 100%; padding: .75rem; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem; transition: border-color 0.2s, box-shadow 0.2s; }
        .form-group input:focus, .form-group textarea:focus { border-color: #667eea; box-shadow: 0 0 0 0.2rem rgba(102,126,234,.25); outline:none;}
        .form-group textarea { min-height: 120px; resize: vertical; }
        .form-submit-button { background: linear-gradient(45deg, #667eea, #764ba2); color: white; padding: .8rem 1.5rem; border: none; border-radius: 25px; font-size: 1.1rem; cursor: pointer; transition: all 0.3s; }
        .form-submit-button:hover { transform: scale(1.05); }
        .contact-email-info { margin-top:1.5rem; text-align:center; font-size:0.9rem; color:#666; }
        #formSubmissionMessage { text-align: center; padding: 1rem; border-radius: 5px; margin-top: 1rem; font-weight:bold; }
        #formSubmissionMessage.success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        
        /* ====[ Back to Top Button ]==== */
        #backToTopBtn {
            display: none; position: fixed; bottom: 30px; right: 30px; z-index: 999;
            background: linear-gradient(45deg, #667eea, #764ba2); color: white;
            border: none; border-radius: 50%; width: 50px; height: 50px;
            font-size: 24px; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
            opacity: 0; visibility: hidden; transform: translateY(10px) scale(0.9);
            display: flex; align-items: center; justify-content: center;
        }
        #backToTopBtn.show { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }
        #backToTopBtn:hover { background: linear-gradient(45deg, #5a6fcf, #694291); transform: scale(1.1); }

        /* ====[ Animations & Mobile Styles ]==== */
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; transform: translateY(20px); } }
        
        @media (max-width: 768px) {
            body { padding-top: 0; } 
            header { 
                position: static; 
                height: auto; 
                padding: 0.75rem 0;
            }
            .header-content { flex-direction: row; justify-content: space-between; align-items: center; padding: 0 1rem;}
            .logo-container { height: 40px; }
            
            nav#mainNav { 
                display: none; 
                position: absolute;
                top: 65px; 
                left: 0;
                width: 100%;
                background: rgba(51, 51, 51, 0.98); 
                backdrop-filter: blur(5px);
                flex-direction: column;
                align-items: center;
                border-top: 1px solid rgba(255,255,255,0.1);
                box-shadow: 0 4px 10px rgba(0,0,0,0.2);
                max-height: 0; 
                overflow: hidden;
                transition: max-height 0.3s ease-out, padding 0.3s ease-out; 
            }
            nav#mainNav.active { 
                display: flex;
                max-height: calc(100vh - 65px); 
                padding-bottom: 1rem;
            }
            nav#mainNav ul { flex-direction: column; gap: 0; text-align: center; width: 100%; padding: 0.5rem 0; }
            nav#mainNav a { display:block; padding: 1rem; width: 100%; border-bottom: 1px solid rgba(255,255,255,0.05); border-radius:0; }
            nav#mainNav li:last-child a { border-bottom: none; }
            nav#mainNav a:hover, nav#mainNav a.active { color: #ffa500; background-color: rgba(255,255,255,0.05); border-bottom-color: transparent; }
            
            .menu-toggle { display: flex; flex-direction:column; justify-content:space-around; }
            .menu-toggle.active .bar:nth-child(1) { transform: translateY(8px) rotate(45deg); }
            .menu-toggle.active .bar:nth-child(2) { opacity: 0; }
            .menu-toggle.active .bar:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }
            
            .hero h1 { font-size: 2rem; }
            .section { padding: 2rem 0; }
            .section-title { font-size: 2rem; margin-bottom: 2rem; }
            .modal-product { grid-template-columns: 1fr; }
            .filters-toolbar { flex-direction: column; align-items: stretch;}
            .filter-group { justify-content: center; margin-bottom: 0.5rem; }
            .filters-toolbar select, .filters-toolbar button.filter-btn {width: 100%; margin-bottom: 0.5rem;}
             .review-post { padding: 1rem; }
            .review-post h3 { font-size: 1.5rem; }
        }

        /* ====[ Review Post Style ]==== */
        .review-post {
            background: #ffffff;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
            opacity: 0; transform: translateY(20px); transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .review-post.visible { opacity: 1; transform: translateY(0); }
        .review-post h3 {
            color: #764ba2; 
            margin-bottom: 0.5em;
        }
        .review-post .review-meta {
            font-size: 0.85rem;
            color: #777;
            margin-bottom: 1rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }
        .review-post p {
            margin-bottom: 1em;
            line-height: 1.7;
        }
        .review-post img.review-image {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <header id="mainHeader">
        <div class="container">
            <div class="header-content">
                <div class="logo-container">
                    <a href="#home">
                        <img src="https://i.postimg.cc/N2qDx2sV/logo-alibest.webp" alt="ALIBEST DEALS Logo" onerror="this.style.display='none';">
                        <!-- Fallback text logo removed as image logo has text -->
                    </a>
                </div>
                <nav id="mainNav">
                     <ul> <!-- Order for RTL visual (Right to Left): Home, Products, Hot Deals, Reviews, Requests -->
                        <li><a href="#home" class="nav-link active">Home</a></li>
                        <li><a href="#productsSection" class="nav-link">Products</a></li>
                        <li><a href="#hotDealsSection" class="nav-link">Hot Deals</a></li>
                        <li><a href="#reviewsSection" class="nav-link">Reviews</a></li>
                        <li><a href="#requestsSection" class="nav-link">Requests</a></li>
                    </ul>
                </nav>
                <div class="menu-toggle" id="mobileMenuToggle">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </div>
    </header>

    <main id="mainContent">
        <section class="hero section" id="home">
             <div class="container">
                <h1>Amazing LEGO Deals, Unbeatable Prices!</h1>
                <p>Discover the best LEGO compatible sets from around the world. Fast shipping, quality builds.</p>
                <a href="#productsSection" class="cta-button">Shop LEGO Sets</a>
            </div>
        </section>

        <section class="featured section" id="productsSection">
            <div class="container">
                <h2 class="section-title">Our LEGO Collection</h2>
                <div class="filters-toolbar">
                    <div class="filter-group" id="categoryFilters">
                        <strong>Categories:</strong>
                    </div>
                    <div class="filter-group">
                        <strong>Sort by:</strong>
                        <select id="sortOptions" class="sort-select">
                            <option value="default">Default</option>
                            <option value="priceLowToHigh">Price: Low to High</option>
                            <option value="priceHighToLow">Price: High to Low</option>
                            <option value="nameAZ">Name: A-Z</option>
                            <option value="nameZA">Name: Z-A</option>
                            <option value="ratingHighToLow">Rating: High to Low</option>
                            <option value="mostReviews">Most Reviews</option>
                        </select>
                    </div>
                </div>
                <div class="products-grid" id="productsGrid"></div>
            </div>
        </section>

        <section class="section" id="hotDealsSection" style="background-color: #f0f8ff;">
            <div class="container">
                <h2 class="section-title">🔥 Today's Hot Deals!</h2>
                <div class="products-grid" id="hotDealsGrid"></div>
            </div>
        </section>

        <section class="section" id="reviewsSection">
            <div class="container">
                <h2 class="section-title">Our LEGO Insights & Reviews</h2>
                <article class="review-post">
                    <h3>Deep Dive: The Architectural Marvels Series</h3>
                    <p class="review-meta">Posted on May 30, 2025 by Alibest Deals Admin</p>
                    <img src="https://via.placeholder.com/800x400.png?text=LEGO+Architecture+Inspiration" alt="LEGO Architecture Inspiration" class="review-image">
                    <p>Welcome to our review corner! Today, we're taking a closer look at the breathtaking Architectural Marvels series available through our partners on AliExpress. These sets are not just toys; they are intricate models that challenge your building skills and result in stunning display pieces.</p>
                    <p>We've found that sets like the "Eiffel Tower" and "The Colosseum" offer incredible detail and a rewarding building experience. The quality of the bricks is generally very high, providing good clutch power and a satisfying click. While these are LEGO-compatible sets, the value for money is often exceptional compared to brand-name counterparts.</p>
                    <h4>What to Look For:</h4>
                    <ul>
                        <li><strong>Piece Count vs. Price:</strong> Generally, a higher piece count for a lower price indicates great value, but also consider the complexity and final size.</li>
                        <li><strong>Seller Ratings:</strong> Always check seller ratings and reviews on AliExpress before purchasing.</li>
                        <li><strong>Shipping Times:</strong> These can vary, so plan accordingly if you're buying for a specific occasion.</li>
                    </ul>
                    <p>Stay tuned for more in-depth reviews and build logs for specific sets! Have a set you'd like us to review? Let us know via our Requests page.</p>
                </article>
            </div>
        </section>

        <section class="section" id="requestsSection" style="background-color: #f9f9f9;">
            <div class="container">
                <h2 class="section-title">Contact Us / Product Requests</h2>
                <div class="form-section">
                    <p style="text-align:center; margin-bottom:1.5rem; color:#555;">
                        Have a request for a specific LEGO set you'd like to see? Found an issue with a link or product information on our site? Or just want to say hello?
                        We're here to help!
                    </p>
                    <form id="contactForm">
                        <div class="form-group"> <label for="contactName">Your Name:</label> <input type="text" id="contactName" name="name" required> </div>
                        <div class="form-group"> <label for="contactEmail">Your Email:</label> <input type="email" id="contactEmail" name="email" required> </div>
                        <div class="form-group"> <label for="contactSubject">Subject / Product Name (if applicable):</label> <input type="text" id="contactSubject" name="subject" required> </div>
                        <div class="form-group"> <label for="contactMessage">Your Message / Request:</label> <textarea id="contactMessage" name="message" required></textarea> </div>
                        <div style="text-align: center;"> <button type="submit" class="form-submit-button">Send Message</button> </div>
                    </form>
                    <div id="formSubmissionMessage" style="display:none; margin-top:1rem;"></div>
                    <p class="contact-email-info"> Alternatively, you can email us directly at: <a href="mailto:alibestdeals24@gmail.com">alibestdeals24@gmail.com</a> </p>
                </div>
            </div>
        </section>

        <section class="why-choose section">
             <div class="container">
                <h2 class="section-title">Why Shop LEGO Deals Here?</h2>
                <div class="features-grid">
                    <div class="feature-card"><div class="feature-icon">🚚</div><h3>Fast Worldwide Shipping</h3><p>Reliable shipping on all LEGO sets. Track your order worldwide.</p></div>
                    <div class="feature-card"><div class="feature-icon">🧱</div><h3>Quality Building Sets</h3><p>High-quality LEGO compatible bricks for a great building experience.</p></div>
                    <div class="feature-card"><div class="feature-icon">💰</div><h3>Best Prices on Sets</h3><p>Unbeatable prices with exclusive deals on popular LEGO themes.</p></div>
                    <div class="feature-card"><div class="feature-icon">🎧</div><h3>Helpful Support</h3><p>Questions about products or links? We're happy to assist via our contact form.</p></div>
                </div>
            </div>
        </section>
    </main> 

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section"><h3>ALIBEST DEALS</h3><p>Your trusted source for amazing LEGO products at unbeatable prices.</p></div>
                <div class="footer-section"><h3>Quick Links</h3><a href="#home">Home</a><a href="#productsSection">Products</a><a href="#hotDealsSection">Hot Deals</a><a href="#reviewsSection">Reviews</a><a href="#requestsSection">Requests</a></div>
                <div class="footer-section"><h3>Contact Us</h3><a href="#requestsSection">Send a Message</a><p>Email: alibestdeals24@gmail.com</p></div>
                <div class="footer-section"><h3>Disclaimer</h3><p>As an AliExpress affiliate, we earn from qualifying purchases. Prices and availability are subject to change.</p></div>
            </div>
            <div style="border-top: 1px solid #555; padding-top: 1rem; margin-top: 2rem;"><p>© <span id="currentYear"></span> ALIBEST DEALS. All rights reserved.</p></div>
        </div>
    </footer>

    <button id="backToTopBtn" title="Go to top">↑</button>

    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">×</span>
            <div class="modal-product" id="modalContent"></div>
        </div>
    </div>

    <script>
    // ====[ JavaScript - Updated for Google Sheets Integration & UI Enhancements ]====
    const GOOGLE_SHEET_API_URL = 'https://script.google.com/macros/s/AKfycbwoJV4Li2nE9N5ZSn_oZ8cTBy10I6r16Pa2kJciRyruPPIfCZ-KVcPTj4f7FnvHE-FSnw/exec'; 

    let allProducts = []; 
    let currentProducts = [];     
    let categories = [];      
    let headerHeight = 70; 

    function setBodyPadding() {
        const header = document.getElementById('mainHeader');
        if (header) {
            if (window.innerWidth > 768 && window.getComputedStyle(header).position === 'fixed') {
                headerHeight = header.offsetHeight;
                document.body.style.paddingTop = headerHeight + 'px';
            } else {
                document.body.style.paddingTop = '0'; 
            }
        }
    }

    function processIncomingProducts(rawProductsData) {
        return rawProductsData.map((p, index) => {
            const price = parseFloat(p.price) || 0;
            const rating = parseFloat(p.rating) || (Math.random() * (4.9 - 3.8) + 3.8).toFixed(1);
            const reviews = parseInt(p.reviews_count) || Math.floor(Math.random() * 700) + 50;
            
            return {
                id: p.id ? parseInt(p.id) : (index + 1) * 1000 + Math.floor(Math.random()*1000), 
                category: p.category || "Uncategorized",
                name: p.name || "Unnamed Product",
                pieces: parseInt(p.pieces) || 0,
                price: price,
                link: p.link || "#",
                image: p.image || "https://via.placeholder.com/400x300.png?text=No+Image",
                description: p.description || `Explore the ${p.name || "product"}, a great find on AliExpress!`,
                originalPrice: parseFloat(p.original_price) || (price / (1 - ((Math.random() * 15 + 20) / 100))).toFixed(2),
                discount: parseInt(p.discount || p.discount_percentage) || Math.floor(Math.random() * 15) + 20, 
                rating: rating,
                reviews: reviews,
                isHotDeal: (p.is_hot_deal && p.is_hot_deal.toString().toLowerCase() === 'true') || (rating >= 4.6 && reviews >= 450)
            };
        });
    }
    
    const observerOptions = { root: null, rootMargin: '0px', threshold: 0.1 };
    function revealOnScroll(entries, observer) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
            }
        });
    }
    const scrollObserver = new IntersectionObserver(revealOnScroll, observerOptions);

    let navLinkObserver;
    function setupNavLinkObserver() {
        const sections = document.querySelectorAll('main .section'); 
        const navLinks = document.querySelectorAll('nav#mainNav a.nav-link');
        const header = document.getElementById('mainHeader');
        let currentHeaderHeight = 0;
        if (header && window.innerWidth > 768 && window.getComputedStyle(header).position === 'fixed') {
            currentHeaderHeight = header.offsetHeight;
        }

        const observerOptionsNav = {
            root: null, 
            rootMargin: `-${currentHeaderHeight + 30}px 0px -${window.innerHeight - currentHeaderHeight - 180}px 0px`, 
            threshold: 0 
        };

        if (navLinkObserver) navLinkObserver.disconnect(); 

        navLinkObserver = new IntersectionObserver(entries => {
            let lastIntersectingSectionId = null;
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    lastIntersectingSectionId = entry.target.getAttribute('id');
                }
            });

            navLinks.forEach(link => link.classList.remove('active'));

            if (lastIntersectingSectionId) {
                const activeLink = document.querySelector(`nav#mainNav a[href="#${lastIntersectingSectionId}"]`);
                if (activeLink) activeLink.classList.add('active');
            } else if (window.pageYOffset < window.innerHeight / 2) { 
                 const homeLink = document.querySelector('nav#mainNav a[href="#home"]');
                 if (homeLink) homeLink.classList.add('active');
            }
        }, observerOptionsNav);

        sections.forEach(section => {
            if (section) navLinkObserver.observe(section);
        });
    }

    async function fetchProductsFromGoogleSheet() {
        const productsGrid = document.getElementById('productsGrid');
        const hotDealsGrid = document.getElementById('hotDealsGrid');
        
        function displayLoadingError(message) {
            console.error(message);
            if (productsGrid) productsGrid.innerHTML = `<p style="color:red; text-align:center; padding:20px;">${message}</p>`;
            if (hotDealsGrid) hotDealsGrid.innerHTML = `<p style="color:red; text-align:center; padding:20px;">${message}</p>`;
        }

        if (!GOOGLE_SHEET_API_URL || GOOGLE_SHEET_API_URL === 'YOUR_WEB_APP_URL_FROM_GOOGLE_APPS_SCRIPT_HERE') { // Safety check
            displayLoadingError("Error: Google Sheet API URL is not configured in the script.");
            return;
        }
        
        if (productsGrid) productsGrid.innerHTML = '<p style="text-align:center; padding: 20px;">Loading products...</p>';
        if (hotDealsGrid) hotDealsGrid.innerHTML = '<p style="text-align:center; padding: 20px;">Loading hot deals...</p>';

        try {
            const response = await fetch(GOOGLE_SHEET_API_URL);
            if (!response.ok) {
                throw new Error(`Network response was not ok: ${response.status} - ${response.statusText}. Check Web App URL and permissions.`);
            }
            const rawProductsData = await response.json();

            if (rawProductsData.error) { throw new Error(`API Error from Google Sheet: ${rawProductsData.error}`); }
            if (!Array.isArray(rawProductsData)) { throw new Error("Data from API is not in the expected array format."); }
            if (rawProductsData.length === 0 && !rawProductsData.warning) { 
                displayLoadingError("No products found in the Google Sheet.");
                return;
            }
            if (rawProductsData.warning && rawProductsData.length === 0) { 
                 displayLoadingError(rawProductsData.warning);
                 return;
            }

            allProducts = processIncomingProducts(rawProductsData);
            currentProducts = [...allProducts];
            populateCategories(); 
            loadProducts(currentProducts, 'productsGrid');
            loadProducts(allProducts.filter(p => p.isHotDeal), 'hotDealsGrid');
            
            document.querySelectorAll('.product-card').forEach(el => { 
                scrollObserver.observe(el);
            });

        } catch (error) {
            displayLoadingError(`Failed to load products: ${error.message}. Check console and ensure Google Sheet Web App is deployed correctly with 'Anyone' access.`);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        setBodyPadding(); 
        window.addEventListener('resize', setBodyPadding); 

        fetchProductsFromGoogleSheet().then(() => {
            setupEventListeners(); 
            setupNavLinkObserver();
        });
        
        showNotification('Welcome to ALIBEST DEALS! 🎉 Your LEGO adventure starts now!', 'info', 5000);
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        
        document.querySelectorAll('nav#mainNav a[href^="#"], .cta-button[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    const header = document.getElementById('mainHeader');
                    let currentHeaderOffset = 0;
                     if (window.innerWidth > 768 && window.getComputedStyle(header).position === 'fixed') {
                        currentHeaderOffset = header.offsetHeight;
                    }
                    const elementPosition = targetElement.getBoundingClientRect().top;
                    const finalScrollPosition = elementPosition + window.pageYOffset - currentHeaderOffset - 15; 

                    window.scrollTo({ top: finalScrollPosition, behavior: 'smooth' });
                    
                    if(this.classList.contains('nav-link')) {
                        document.querySelectorAll('nav#mainNav a.active').forEach(activeLink => activeLink.classList.remove('active'));
                        this.classList.add('active');
                        const navMenu = document.getElementById('mainNav');
                        const menuToggle = document.getElementById('mobileMenuToggle');
                        if (navMenu.classList.contains('active')) { 
                            navMenu.classList.remove('active');
                            menuToggle.classList.remove('active');
                        }
                    }
                }
            });
        });

        const backToTopButton = document.getElementById('backToTopBtn');
        if (backToTopButton) {
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 200) {
                    backToTopButton.classList.add('show');
                } else {
                    backToTopButton.classList.remove('show');
                }
            });
            backToTopButton.addEventListener('click', () => {
                window.scrollTo({top: 0, behavior: 'smooth'});
            });
        }
        
        document.querySelectorAll('.section-title, .feature-card').forEach(el => {
            scrollObserver.observe(el);
        });

        const menuToggle = document.getElementById('mobileMenuToggle');
        const mainNav = document.getElementById('mainNav');
        if (menuToggle && mainNav) {
            menuToggle.addEventListener('click', () => {
                mainNav.classList.toggle('active');
                menuToggle.classList.toggle('active');
            });
        }
    });
    
    function setupEventListeners() {
        const categoryFiltersContainer = document.getElementById('categoryFilters');
        if (categoryFiltersContainer) {
            categoryFiltersContainer.addEventListener('click', function(event) {
                if (event.target.classList.contains('filter-btn')) {
                    const category = event.target.dataset.category;
                    filterByCategory(category); 
                    categoryFiltersContainer.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                    event.target.classList.add('active');
                }
            });
        }

        const sortOrderSelect = document.getElementById('sortOptions');
        if (sortOrderSelect) {
            sortOrderSelect.addEventListener('change', function() {
                sortProducts(this.value);
            });
        }
        
        const contactForm = document.getElementById('contactForm');
        if(contactForm) {
            contactForm.addEventListener('submit', handleContactFormSubmit);
        }
    }

    function populateCategories() {
        if (typeof allProducts === 'undefined' || !allProducts.length) return;
        const uniqueCategories = [...new Set(allProducts.map(p => p.category))];
        categories = uniqueCategories.sort();
        const categoryFiltersContainer = document.getElementById('categoryFilters');
        if (categoryFiltersContainer) {
            categoryFiltersContainer.innerHTML = '<strong>Categories:</strong> '; 
            
            const allButton = document.createElement('button');
            allButton.classList.add('filter-btn', 'active'); 
            allButton.dataset.category = 'all';
            allButton.textContent = 'All Products';
            categoryFiltersContainer.appendChild(allButton);

            categories.forEach(category => {
                const button = document.createElement('button');
                button.classList.add('filter-btn');
                button.dataset.category = category;
                button.textContent = category;
                categoryFiltersContainer.appendChild(button);
            });
        }
    }

    function filterByCategory(category) {
        let productsToDisplay;
        if (category === 'all') {
            productsToDisplay = [...allProducts];
        } else {
            productsToDisplay = allProducts.filter(p => p.category === category);
        }
        currentProducts = productsToDisplay; 
        document.getElementById('sortOptions').value = 'default'; 
        loadProducts(currentProducts, 'productsGrid'); 
    }
        
    function sortProducts(sortValue) {
        let productsToSort = [...currentProducts]; 
        switch (sortValue) {
            case 'priceLowToHigh': productsToSort.sort((a, b) => a.price - b.price); break;
            case 'priceHighToLow': productsToSort.sort((a, b) => b.price - a.price); break;
            case 'nameAZ': productsToSort.sort((a, b) => a.name.localeCompare(b.name)); break;
            case 'nameZA': productsToSort.sort((a, b) => b.name.localeCompare(a.name)); break;
            case 'ratingHighToLow': productsToSort.sort((a,b) => parseFloat(b.rating) - parseFloat(a.rating)); break;
            case 'mostReviews': productsToSort.sort((a,b) => parseInt(b.reviews) - parseInt(a.reviews)); break;
            default:
                const activeCategoryButton = document.querySelector('#categoryFilters .filter-btn.active');
                const activeCategory = activeCategoryButton ? activeCategoryButton.dataset.category : 'all';
                filterByCategory(activeCategory); 
                return; 
        }
        loadProducts(productsToSort, 'productsGrid'); 
    }

    function loadProducts(productsToDisplay, targetGridId) {
        const grid = document.getElementById(targetGridId);
        if (!grid) {
            console.error(`Grid element with ID '${targetGridId}' not found!`);
            return;
        }

        if (!productsToDisplay || productsToDisplay.length === 0) {
            if (targetGridId === 'hotDealsGrid') {
                grid.innerHTML = '<p style="text-align:center; padding: 20px; grid-column: 1 / -1;">No hot deals available at the moment. Check back soon!</p>';
            } else {
                grid.innerHTML = '<p style="text-align:center; padding: 20px; grid-column: 1 / -1;">No products match your criteria.</p>';
            }
            return;
        }
        grid.innerHTML = ''; 
        productsToDisplay.forEach((product, index) => {
            const cardHTML = generateProductHTML(product);
            const tempDiv = document.createElement('div'); 
            tempDiv.innerHTML = cardHTML.trim(); 
            const actualCard = tempDiv.firstChild; 
            
            if(actualCard) {
                actualCard.style.transitionDelay = `${index * 0.035}s`; 
                grid.appendChild(actualCard);
                setTimeout(() => { 
                    actualCard.classList.add('visible');
                }, 10);
                scrollObserver.observe(actualCard); 
            }
        });
    }

    function generateProductHTML(product) {
        return `
            <div class="product-card"> 
                <div class="product-image-container" onclick="showProduct(${product.id})">
                    <div class="product-badges">
                        ${product.isHotDeal ? '<span class="badge hot-deal-badge">🔥 Hot!</span>' : ''}
                        <span class="badge discount-badge">${product.discount}% OFF</span>
                    </div>
                    <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.onerror=null;this.src='https://via.placeholder.com/400x300.png?text=Image+Not+Found';">
                </div>
                <div class="product-info">
                    <h3 class="product-title" onclick="showProduct(${product.id})">${product.name}</h3>
                    <p class="product-description">${product.description}</p>
                     <div class="product-rating">
                        <div class="stars">${'★'.repeat(Math.floor(parseFloat(product.rating)))}${(parseFloat(product.rating) % 1) >= 0.5 ? '★' : (parseFloat(product.rating) % 1) > 0 ? '☆' : ''}${'☆'.repeat(5 - Math.ceil(parseFloat(product.rating)))}</div>
                        <span class="rating-count">(${product.reviews} reviews)</span>
                    </div>
                    <div class="product-price">
                        <span class="current-price">$${product.price.toFixed(2)}</span>
                        <span class="original-price">$${product.originalPrice}</span>
                    </div>
                    <a href="${product.link}" target="_blank" class="product-action-button">
                        View on AliExpress
                    </a>
                </div>
            </div>
        `;
    }
    
    function showProduct(productId) {
        const product = allProducts.find(p => p.id === productId); 
        if (!product) return;
        const modal = document.getElementById('productModal');
        const content = document.getElementById('modalContent');
        content.innerHTML = `
            <div class="modal-image-container"> <img src="${product.image}" alt="${product.name}" class="modal-image" onerror="this.onerror=null;this.src='https://via.placeholder.com/400x300.png?text=No+Image';"> </div>
            <div>
                <h2>${product.name}</h2>
                <div class="product-rating" style="margin-bottom: 1rem;">
                    <div class="stars">${'★'.repeat(Math.floor(parseFloat(product.rating)))}${(parseFloat(product.rating) % 1) >= 0.5 ? '★' : (parseFloat(product.rating) % 1) > 0 ? '☆' : ''}${'☆'.repeat(5 - Math.ceil(parseFloat(product.rating)))}</div>
                    <span class="rating-count">(${product.reviews} reviews)</span>
                </div>
                <p style="font-size:0.9rem; color:#666;">Category: ${product.category} | Pieces: ${product.pieces}</p>
                <p style="margin: 1rem 0; color: #555; line-height: 1.6;"> ${product.description} This premium quality compatible set offers exceptional value. Fast worldwide shipping available from AliExpress. </p>
                <div class="product-price" style="margin: 1.5rem 0;">
                    <span class="current-price" style="font-size: 2rem;">$${product.price.toFixed(2)}</span>
                    <span class="original-price" style="font-size: 1.2rem;">$${product.originalPrice}</span>
                    <span class="discount">${product.discount}% OFF</span>
                </div>
                <button class="modal-report-button" onclick="prepareContactFormForProduct(${product.id})">Report issue / Ask about this product</button>
                <div style="display: flex; gap: 1rem; margin-top: 1rem;"> <a href="${product.link}" target="_blank" class="cta-button" style="flex: 1; text-align: center; text-decoration: none;"> Buy on AliExpress </a> </div>
            </div>`;
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden'; 
    }

    function closeModal() {
        document.getElementById('productModal').style.display = 'none';
        document.body.style.overflow = 'auto'; 
    }
    
    function prepareContactFormForProduct(productId) {
        const product = allProducts.find(p => p.id === productId);
        if (!product) return;
        const contactSubjectField = document.getElementById('contactSubject');
        const contactMessageField = document.getElementById('contactMessage');
        if (contactSubjectField) contactSubjectField.value = `Query about: ${product.name} (ID: ${product.id})`;
        if (contactMessageField) {
            contactMessageField.placeholder = `Please describe your question or issue regarding ${product.name}...`;
            contactMessageField.value = ''; 
        }
        closeModal(); 
        const requestsSection = document.getElementById('requestsSection');
        if (requestsSection) {
            const header = document.getElementById('mainHeader');
            let currentHeaderOffset = 0; 
            if (window.innerWidth > 768 && window.getComputedStyle(header).position === 'fixed') { 
                currentHeaderOffset = header.offsetHeight;
            }
            const elementPosition = requestsSection.getBoundingClientRect().top;
            const finalScrollPosition = elementPosition + window.pageYOffset - currentHeaderOffset - 20; 
            window.scrollTo({ top: finalScrollPosition, behavior: 'smooth' });
        }
        if (contactMessageField) contactMessageField.focus();
    }

    function handleContactFormSubmit(event) {
        event.preventDefault();
        const form = event.target;
        const messageDiv = document.getElementById('formSubmissionMessage');
        messageDiv.textContent = 'Thank you for your message! If your query is urgent, please also email us directly at alibestdeals24@gmail.com. We will do our best to respond shortly.';
        messageDiv.className = 'form-submission-message success';
        messageDiv.style.display = 'block';
        form.reset(); 
        setTimeout(() => { messageDiv.style.display = 'none'; }, 7000);
    }

    function showNotification(message, type = 'success', duration = 3000) {
        const notification = document.createElement('div');
        notification.style.position = 'fixed';
        notification.style.bottom = '20px';
        notification.style.left = '50%';
        notification.style.transform = 'translateX(-50%) translateY(100px)';
        let bgColor = 'linear-gradient(45deg, #4CAF50, #8BC34A)'; 
        if (type === 'error') bgColor = 'linear-gradient(45deg, #ff416c, #ff4b2b)';
        else if (type === 'info') bgColor = 'linear-gradient(45deg, #2196F3, #21CBF3)';
        notification.style.background = bgColor;
        notification.style.color = 'white';
        notification.style.padding = '12px 20px';
        notification.style.borderRadius = '8px';
        notification.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
        notification.style.zIndex = '10002';
        notification.style.fontSize = '0.9rem';
        notification.style.opacity = '0';
        notification.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
        notification.textContent = message;
        document.body.appendChild(notification);
        setTimeout(() => {
            notification.style.opacity = '1';
            notification.style.transform = 'translateX(-50%) translateY(0)';
        }, 10);
        setTimeout(() => {
            notification.style.opacity = '0';
            notification.style.transform = 'translateX(-50%) translateY(20px)';
            setTimeout(() => {
                if (notification.parentNode) notification.parentNode.removeChild(notification);
            }, 300);
        }, duration);
    }
    </script>
</body>
</html>